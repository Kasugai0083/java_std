package com.example.sample1app.repositories;

import java.util.List;

import jakarta.persistence.EntityManager;
import jakarta.persistence.PersistenceContext;
import jakarta.persistence.criteria.CriteriaBuilder;
import jakarta.persistence.criteria.CriteriaQuery;
import jakarta.persistence.criteria.Root;

import org.springframework.stereotype.Repository;

import com.example.sample1app.Message;
import com.example.sample1app.PersonDAO;

@Repository
public class PersonDAOMessageImpl implements PersonDAO<Message>{
	private static final long serialVersionID = 1L;
	
	@PersistenceContext
	private EntityManager entityManager;
	
	public PersonDAOMessageImpl() {super();}
	
	@Override
	public List<Message> getAll(){
		List<Message> list = null;
		
		CriteriaBuilder builder = entityManager.getCriteriaBuilder();
		CriteriaQuery<Message> query = builder.createQuery(Message.class);
		Root<Message> root = query.from(Message.class);
		query.select(root).orderBy(builder.desc(root.get("datetime")));
		list = (list<Message>)entityManager
				.createQuery(query)
				.getResultList();
		
		return list;
	}
}
